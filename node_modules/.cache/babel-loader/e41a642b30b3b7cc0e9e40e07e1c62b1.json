{"ast":null,"code":"var _jsxFileName = \"/industry/app/src/DashboardManage/AddView.js\";\n\n/** @jsx jsx */\nimport React, { Component } from 'react';\nimport { jsx, css } from '@emotion/core';\nimport styled from '@emotion/styled';\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport { Scrollbars } from 'react-custom-scrollbars';\nimport { wyAxiosPost } from '../components/WyAxios';\nimport GenerateViewContainer from './GenerateViewContainer';\n\nclass AddView extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      visible: false,\n      sHeight: '0px',\n      layout: [],\n      modules: []\n    };\n\n    this.dropEvent = event => {\n      const e = event || window.event;\n      e.preventDefault();\n      const data = JSON.parse(e.dataTransfer.getData(\"viewattr\")); //随机数作为id\n\n      const randomCount = Math.random();\n      const curTime = new Date().getTime();\n      const asId = parseInt(randomCount, 10) + parseInt(curTime, 10) * 100;\n      const id = asId.toString();\n      data.id = id;\n      data.position = {\n        i: id,\n        h: 13,\n        w: 12,\n        x: 0,\n        y: 0\n      };\n      data.data = {};\n      this.props.doAdd(data);\n    };\n\n    this.dragOverEvent = event => {\n      const e = event || window.event;\n      e.preventDefault();\n    };\n\n    this.dragStartEvent = event => {\n      const e = event || window.event;\n      e.dataTransfer.setData(\"viewattr\", e.target.getAttribute('viewattr'));\n    };\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n    const windowH = parseInt(document.body.clientHeight, 0) - 104;\n\n    if (this._isMounted) {\n      this.setState({\n        sHeight: windowH + 'px'\n      });\n    }\n\n    $(window).resize(() => {\n      const rwindowH = parseInt(document.body.clientHeight, 0) - 104;\n\n      if (this._isMounted) {\n        this.setState({\n          sHeight: rwindowH + 'px'\n        });\n      }\n    });\n  }\n\n  componentWillReceiveProps(nextProps) {\n    const modules = nextProps.modules;\n\n    if (this._isMounted) {\n      this.setState({\n        modules\n      });\n    }\n  } //拖放事件\n\n\n  render() {\n    return jsx(\"div\", {\n      style: {\n        display: \"flex\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, jsx(\"div\", {\n      style: {\n        flex: \"0 0 100px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, jsx(Scrollbars, {\n      autoHide: true,\n      autoHideTimeout: 100,\n      autoHideDuration: 200,\n      universal: true,\n      style: {\n        height: this.state.sHeight,\n        borderRight: \"rgba(255,255,255,0.2) solid 1px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }, jsx(\"ul\", {\n      style: {\n        padding: \"2px 20px 2px 20px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93\n      },\n      __self: this\n    }, jsx(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, jsx(\"div\", {\n      style: {\n        width: \"100%\",\n        height: \"100px\",\n        cursor: \"move\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, jsx(\"img\", {\n      src: require(\"../asets/map.png\"),\n      alt: \"\",\n      width: \"100%\",\n      draggable: true,\n      viewattr: \"{\\\"viewType\\\":\\\"map\\\"}\",\n      onDragStart: this.dragStartEvent,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }))), jsx(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, jsx(\"div\", {\n      style: {\n        width: \"100%\",\n        height: \"100px\",\n        cursor: \"move\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, jsx(\"img\", {\n      src: require(\"../asets/line.png\"),\n      alt: \"\",\n      width: \"100%\",\n      draggable: true,\n      viewattr: \"{\\\"viewType\\\":\\\"line\\\"}\",\n      onDragStart: this.dragStartEvent,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }))), jsx(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, jsx(\"div\", {\n      style: {\n        width: \"100%\",\n        height: \"100px\",\n        cursor: \"move\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, jsx(\"img\", {\n      src: require(\"../asets/bar.png\"),\n      alt: \"\",\n      width: \"100%\",\n      draggable: true,\n      viewattr: \"{\\\"viewType\\\":\\\"bar\\\"}\",\n      onDragStart: this.dragStartEvent,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }))), jsx(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, jsx(\"div\", {\n      style: {\n        width: \"100%\",\n        height: \"100px\",\n        cursor: \"move\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, jsx(\"img\", {\n      src: require(\"../asets/column.png\"),\n      alt: \"\",\n      width: \"100%\",\n      draggable: true,\n      viewattr: \"{\\\"viewType\\\":\\\"column\\\"}\",\n      onDragStart: this.dragStartEvent,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }))), jsx(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, jsx(\"div\", {\n      style: {\n        width: \"100%\",\n        height: \"100px\",\n        cursor: \"move\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, jsx(\"img\", {\n      src: require(\"../asets/pie.png\"),\n      alt: \"\",\n      width: \"100%\",\n      draggable: true,\n      viewattr: \"{\\\"viewType\\\":\\\"pie\\\"}\",\n      onDragStart: this.dragStartEvent,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }))), jsx(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, jsx(\"div\", {\n      style: {\n        width: \"100%\",\n        height: \"100px\",\n        cursor: \"move\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, jsx(\"img\", {\n      src: require(\"../asets/table.png\"),\n      alt: \"\",\n      width: \"100%\",\n      draggable: true,\n      viewattr: \"{\\\"viewType\\\":\\\"table\\\"}\",\n      onDragStart: this.dragStartEvent,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }))), jsx(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, jsx(\"div\", {\n      style: {\n        width: \"100%\",\n        height: \"100px\",\n        cursor: \"move\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, jsx(\"img\", {\n      src: require(\"../asets/calc.png\"),\n      alt: \"\",\n      width: \"100%\",\n      draggable: true,\n      viewattr: \"{\\\"viewType\\\":\\\"calc\\\"}\",\n      onDragStart: this.dragStartEvent,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    })))))), jsx(\"div\", {\n      style: {\n        flex: \"1 1 auto\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, jsx(Scrollbars, {\n      autoHide: true,\n      autoHideTimeout: 100,\n      autoHideDuration: 200,\n      universal: true,\n      style: {\n        height: this.state.sHeight\n      },\n      onDrop: this.dropEvent,\n      onDragOver: this.dragOverEvent,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, jsx(GenerateViewContainer, {\n      onClose: this.props.onClose,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }))));\n  }\n\n}\n\nAddView.defaultProps = {\n  className: \"layout\",\n  cols: 24,\n  margin: [10, 10],\n  rowHeight: 20,\n  autoSize: true,\n  onLayoutChange: function () {}\n};\nexport default AddView;","map":{"version":3,"sources":["/industry/app/src/DashboardManage/AddView.js"],"names":["React","Component","jsx","css","styled","_","$","Scrollbars","wyAxiosPost","GenerateViewContainer","AddView","state","visible","sHeight","layout","modules","dropEvent","event","e","window","preventDefault","data","JSON","parse","dataTransfer","getData","randomCount","Math","random","curTime","Date","getTime","asId","parseInt","id","toString","position","i","h","w","x","y","props","doAdd","dragOverEvent","dragStartEvent","setData","target","getAttribute","componentDidMount","_isMounted","windowH","document","body","clientHeight","setState","resize","rwindowH","componentWillReceiveProps","nextProps","render","display","flex","height","borderRight","padding","width","cursor","require","onClose","defaultProps","className","cols","margin","rowHeight","autoSize","onLayoutChange"],"mappings":"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","sourcesContent":["/** @jsx jsx */\r\nimport React ,{ Component } from 'react'\r\nimport { Button, Row, Col, Input, Select, message } from 'antd'\r\nimport { jsx, css } from '@emotion/core'\r\nimport styled from '@emotion/styled'\r\nimport _ from 'lodash'\r\nimport $ from 'jquery'\r\nimport { Scrollbars } from 'react-custom-scrollbars'\r\n\r\nimport { wyAxiosPost } from '../components/WyAxios'\r\nimport GenerateViewContainer from './GenerateViewContainer'\r\n\r\nclass AddView extends Component{\r\n  static defaultProps = {\r\n    className: \"layout\",\r\n    cols: 24,\r\n    margin:[10,10],\r\n    rowHeight: 20,\r\n    autoSize: true,\r\n    onLayoutChange: function(){}\r\n  }\r\n  state = {\r\n    visible: false,\r\n    sHeight: '0px',\r\n    layout: [],\r\n    modules:[]\r\n  }\r\n  componentDidMount(){\r\n    this._isMounted  = true\r\n    const windowH = parseInt(document.body.clientHeight,0)-104\r\n    if(this._isMounted){\r\n      this.setState({\r\n        sHeight: windowH+'px'\r\n      })\r\n    }\r\n    $(window).resize(()=>{\r\n      const rwindowH = parseInt(document.body.clientHeight,0)-104\r\n      if(this._isMounted){\r\n        this.setState({\r\n          sHeight: rwindowH+'px'\r\n        })\r\n      }\r\n    })\r\n  }\r\n  componentWillReceiveProps(nextProps){\r\n    const modules = nextProps.modules\r\n    if(this._isMounted){\r\n      this.setState({\r\n        modules\r\n      })\r\n    }\r\n  }\r\n  //拖放事件\r\n  dropEvent =  (event)=>{\r\n    const e = event || window.event\r\n    e.preventDefault();\r\n    const data = JSON.parse(e.dataTransfer.getData(\"viewattr\"));\r\n    //随机数作为id\r\n    const randomCount = Math.random();\r\n    const curTime = new Date().getTime();\r\n    const asId = parseInt(randomCount,10) + parseInt(curTime,10)*100\r\n    const id = asId.toString()\r\n    data.id = id\r\n    data.position = {\r\n      i:id,\r\n      h:13,\r\n      w:12,\r\n      x:0,\r\n      y:0\r\n    }\r\n    data.data = {}\r\n    this.props.doAdd(data)\r\n  }\r\n  dragOverEvent = (event)=>{\r\n    const e = event || window.event\r\n    e.preventDefault();\r\n  }\r\n  dragStartEvent = (event)=>{\r\n    const e = event || window.event\r\n    e.dataTransfer.setData(\"viewattr\",e.target.getAttribute('viewattr'));\r\n  }\r\n  render(){\r\n    return (\r\n      <div style={{display: \"flex\"}}>\r\n        <div style={{flex:\"0 0 100px\"}}>\r\n          <Scrollbars\r\n            autoHide\r\n            autoHideTimeout={100}\r\n            autoHideDuration={200}\r\n            universal={true}\r\n            style={{height:this.state.sHeight,borderRight:\"rgba(255,255,255,0.2) solid 1px\"}}\r\n          >\r\n              <ul style={{padding: \"2px 20px 2px 20px\"}}>\r\n                <li>\r\n                  <div\r\n                    style={{width:\"100%\",height:\"100px\",cursor:\"move\"}}\r\n                  >\r\n                    <img\r\n                      src={require(\"../asets/map.png\")} alt=\"\" width=\"100%\"\r\n                      draggable={true}\r\n                      viewattr='{\"viewType\":\"map\"}'\r\n                      onDragStart={this.dragStartEvent}\r\n                    />\r\n                  </div>\r\n                </li>\r\n                <li>\r\n                  <div\r\n                    style={{width:\"100%\",height:\"100px\",cursor:\"move\"}}\r\n                  >\r\n                    <img\r\n                      src={require(\"../asets/line.png\")} alt=\"\" width=\"100%\"\r\n                      draggable={true}\r\n                      viewattr='{\"viewType\":\"line\"}'\r\n                      onDragStart={this.dragStartEvent}\r\n                    />\r\n                  </div>\r\n                </li>\r\n                <li>\r\n                  <div\r\n                    style={{width:\"100%\",height:\"100px\",cursor:\"move\"}}\r\n                  >\r\n                    <img\r\n                      src={require(\"../asets/bar.png\")} alt=\"\" width=\"100%\"\r\n                      draggable={true}\r\n                      viewattr='{\"viewType\":\"bar\"}'\r\n                      onDragStart={this.dragStartEvent}\r\n                    />\r\n                  </div>\r\n                </li>\r\n                <li>\r\n                  <div\r\n                    style={{width:\"100%\",height:\"100px\",cursor:\"move\"}}\r\n                  >\r\n                    <img\r\n                      src={require(\"../asets/column.png\")} alt=\"\" width=\"100%\"\r\n                      draggable={true}\r\n                      viewattr='{\"viewType\":\"column\"}'\r\n                      onDragStart={this.dragStartEvent}\r\n                    />\r\n                  </div>\r\n                </li>\r\n                <li>\r\n                  <div\r\n                    style={{width:\"100%\",height:\"100px\",cursor:\"move\"}}\r\n                  >\r\n                    <img\r\n                      src={require(\"../asets/pie.png\")} alt=\"\" width=\"100%\"\r\n                      draggable={true}\r\n                      viewattr='{\"viewType\":\"pie\"}'\r\n                      onDragStart={this.dragStartEvent}\r\n                    />\r\n                  </div>\r\n                </li>\r\n                <li>\r\n                  <div\r\n                    style={{width:\"100%\",height:\"100px\",cursor:\"move\"}}\r\n                  >\r\n                    <img\r\n                      src={require(\"../asets/table.png\")} alt=\"\" width=\"100%\"\r\n                      draggable={true}\r\n                      viewattr='{\"viewType\":\"table\"}'\r\n                      onDragStart={this.dragStartEvent}\r\n                    />\r\n                  </div>\r\n                </li>\r\n                <li>\r\n                  <div\r\n                    style={{width:\"100%\",height:\"100px\",cursor:\"move\"}}\r\n                  >\r\n                    <img\r\n                      src={require(\"../asets/calc.png\")} alt=\"\" width=\"100%\"\r\n                      draggable={true}\r\n                      viewattr='{\"viewType\":\"calc\"}'\r\n                      onDragStart={this.dragStartEvent}\r\n                    />\r\n                  </div>\r\n                </li>\r\n              </ul>\r\n          </Scrollbars>\r\n        </div>\r\n        <div style={{flex:\"1 1 auto\"}}>\r\n          <Scrollbars\r\n            autoHide\r\n            autoHideTimeout={100}\r\n            autoHideDuration={200}\r\n            universal={true}\r\n            style={{height:this.state.sHeight}}\r\n            onDrop={this.dropEvent}\r\n            onDragOver={this.dragOverEvent}\r\n            >\r\n            {\r\n              <GenerateViewContainer onClose={this.props.onClose}/>\r\n            }\r\n\r\n          </Scrollbars>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n\r\nexport default AddView\r\n"]},"metadata":{},"sourceType":"module"}