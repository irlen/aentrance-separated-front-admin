{"ast":null,"code":"import \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/message/style\";\nimport _message from \"antd/es/message\";\nimport \"antd/es/select/style\";\nimport _Select from \"antd/es/select\";\nvar _jsxFileName = \"/industry/app/src/DashboardManage/GenerateView.js\";\n\n/** @jsx jsx */\nimport { jsx, css } from '@emotion/core';\nimport React, { Component } from 'react';\nimport RGL, { WidthProvider } from \"react-grid-layout\";\nimport _ from 'lodash';\nimport { forName } from '../components/RegExp';\nimport { wyAxiosPost } from '../components/WyAxios';\nimport TemplateForLine from './TemplateForLine';\nimport TemplateForColumn from './TemplateForColumn';\nimport TemplateForTable from './TemplateForTable';\nimport TemplateForPie from './TemplateForPie';\nimport TemplateForMap from './TemplateForMap';\nimport TemplateForCalc from './TemplateForCalc';\nimport ModalTypeContainer from './ModalTypeContainer';\n\nrequire('../../node_modules/react-grid-layout/css/styles.css');\n\nrequire('../../node_modules/react-resizable/css/styles.css');\n\nconst ReactGridLayout = WidthProvider(RGL);\nconst Option = _Select.Option;\n\nclass GenerateView extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      modules: [],\n      layout: [],\n      setId: '',\n      viewType: '',\n      moduleName: '',\n      dataMethod: '',\n      updateTime: '0',\n      visible: false,\n      dataSourceList: []\n    };\n\n    this.onLayoutChange = layout => {\n      const newLayout = [];\n\n      if (layout && layout.length > 0) {\n        layout.map(item => {\n          const i = item.i,\n                h = item.h,\n                w = item.w,\n                x = item.x,\n                y = item.y;\n          newLayout.push({\n            i,\n            h,\n            w,\n            x,\n            y\n          });\n        });\n      }\n\n      if (newLayout.length > 0) {\n        this.props.doSetPosition(newLayout);\n      }\n    };\n\n    this.showModal = (setId, viewType) => {\n      if (this._isMounted) {\n        this.setState({\n          setId,\n          viewType\n        }, () => {\n          this.setState({\n            visible: true\n          });\n        });\n      } // this.state.modules.map((item,index)=>{\n      //   if(item.id === id){\n      //     this.setState({\n      //       moduleName: this.state.modules[index].data?this.state.modules[index].data.moduleName:'',\n      //       dataMethod: this.state.modules[index].data?this.state.modules[index].data.dataMethod:'',\n      //     })\n      //     return\n      //   }\n      // })\n      // this.setState({\n      //   visible: true,\n      //   setId: id,\n      //   viewType\n      // },()=>{\n      // wyAxiosPost('Screen/getScreenApi',{viewType: this.state.viewType},(result)=>{\n      //   const responseData = result.data.msg\n      //   this.setState({\n      //     dataSourceList: _.cloneDeep(responseData)\n      //   })\n      // })\n      //});\n\n    };\n\n    this.handleOk = data => {\n      const erroList = [];\n\n      const validateField = key => {\n        if (key === 'name') {\n          if (data[key] === '' || data[key] === undefined) {\n            erroList.push('名称不能为空');\n          }\n        } else if (key === 'app_name') {\n          if (data[key] === '' || data[key] === undefined) {\n            erroList.push('应用不能为空');\n          }\n        } else if (key === 's_map') {\n          if (data[key] === '' || data[key] === undefined) {\n            erroList.push('地图不能为空');\n          }\n        } else if (key === 's_city') {\n          if (data[key] === '' || data[key] === undefined) {\n            erroList.push('城市不能为空');\n          }\n        } else if (key === 'field') {\n          if (data[key] === '' || data[key] === undefined) {\n            erroList.push('字段不能为空');\n          }\n        }\n      };\n\n      const keys = Object.keys(data);\n\n      if (keys && keys.length > 0) {\n        keys.map(item => {\n          validateField(item);\n        });\n      }\n\n      if (erroList.length === 0) {\n        this.props.doSetData(data);\n        this.handleCancel();\n      } else {\n        let str = '';\n        erroList.map((item, index) => {\n          str += index + 1 + '.' + item + '  ';\n        });\n\n        _message.warning(str);\n      }\n    };\n\n    this.handleCancel = e => {\n      if (this._isMounted) {\n        this.setState({\n          visible: false,\n          setId: '',\n          viewType: '',\n          moduleName: '',\n          dataMethod: ''\n        });\n      }\n    };\n\n    this.dataMethodChange = value => {\n      if (this._isMounted) {\n        let moduleName = '';\n\n        for (let item of this.state.dataSourceList) {\n          if (value === item.api) {\n            moduleName = item.name;\n            break;\n          }\n        }\n\n        this.setState({\n          dataMethod: value,\n          moduleName\n        });\n      }\n    };\n\n    this.updateTimeChange = value => {\n      if (this._isMounted) {\n        this.setState({\n          updateTime: value\n        });\n      }\n    };\n\n    this.saveModules = () => {\n      const info = {};\n      info.modules = this.props.modules;\n      info.updateTime = this.state.updateTime;\n      info.id = this.props.id;\n      wyAxiosPost('Dashboard/saveModule', {\n        info\n      }, result => {\n        const responseData = result.data.msg;\n\n        if (responseData.status === 1) {\n          this.props.onClose();\n\n          _message.success(responseData.msg);\n        } else {\n          _message.warning(responseData.msg);\n        }\n      }); // wyAxiosPost('Screen/saveScreen',{info},(result)=>{\n      //   const responseData = result.data\n      //   if(responseData.status === 1){\n      //     this.props.closeWindow()\n      //     message.success(responseData.msg)\n      //   }else{\n      //     message.warning(responseData.msg)\n      //   }\n      // })\n    };\n\n    this.generatedView = () => {\n      let divArry = [];\n\n      if (this.state.modules && this.state.modules.length > 0) {\n        this.state.modules.map((item, index) => {\n          let compiledPosition = {};\n\n          if (item.position) {\n            const h = parseInt(item.position.h);\n            const w = parseInt(item.position.w);\n            const x = parseInt(item.position.x);\n            const y = parseInt(item.position.y);\n            compiledPosition = Object.assign({}, {\n              h,\n              w,\n              x,\n              y\n            });\n          }\n\n          if (Object.keys(compiledPosition).length > 0) {\n            if (item.viewType === 'line' || item.viewType === 'bar') {\n              divArry.push(jsx(\"div\", {\n                style: {\n                  background: \"rgba(0,0,0,0.4)\",\n                  borderRadius: \"5px\",\n                  overflow: \"hidden\"\n                },\n                key: item.id,\n                \"data-grid\": compiledPosition,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 235\n                },\n                __self: this\n              }, jsx(\"div\", {\n                className: \"moduleHeader\",\n                style: {\n                  width: \"100%\",\n                  height: \"50px\",\n                  lineHeight: \"50px\"\n                },\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 236\n                },\n                __self: this\n              }, jsx(\"span\", {\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 237\n                },\n                __self: this\n              }, item.data ? item.data.name : ''), jsx(\"span\", {\n                style: {\n                  float: \"right\",\n                  display: \"inline-block\",\n                  cursor: \"pointer\"\n                },\n                title: \"\\u5220\\u9664\\u6B64\\u6A21\\u5757\",\n                onClick: () => {\n                  this.props.doDeleteModule(item.id);\n                },\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 238\n                },\n                __self: this\n              }, jsx(\"i\", {\n                className: \"fa fa-times\",\n                \"aria-hidden\": \"true\",\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 243\n                },\n                __self: this\n              })), jsx(\"span\", {\n                style: {\n                  float: \"right\",\n                  margin: \"0 10px 0 0\",\n                  cursor: \"pointer\"\n                },\n                title: \"\\u6A21\\u5757\\u8BBE\\u7F6E\",\n                onClick: () => this.showModal(item.id, item.viewType),\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 245\n                },\n                __self: this\n              }, jsx(\"i\", {\n                className: \"fa fa-cog\",\n                \"aria-hidden\": \"true\",\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 250\n                },\n                __self: this\n              }))), jsx(TemplateForLine, {\n                pageId: this.props.id,\n                env: \"set\",\n                autoHeight: compiledPosition ? compiledPosition.h * 30 - 10 - 70 : 13 * 30 - 10 - 70,\n                showViewData: _.cloneDeep(item),\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 253\n                },\n                __self: this\n              })));\n            } else if (item.viewType === 'column') {\n              divArry.push(jsx(\"div\", {\n                style: {\n                  background: \"rgba(0,0,0,0.4)\",\n                  borderRadius: \"5px\",\n                  overflow: \"hidden\"\n                },\n                key: item.id,\n                \"data-grid\": compiledPosition,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 258\n                },\n                __self: this\n              }, jsx(\"div\", {\n                className: \"moduleHeader\",\n                style: {\n                  width: \"100%\",\n                  height: \"50px\",\n                  lineHeight: \"50px\"\n                },\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 259\n                },\n                __self: this\n              }, jsx(\"span\", {\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 260\n                },\n                __self: this\n              }, item.data ? item.data.name : ''), jsx(\"span\", {\n                style: {\n                  float: \"right\",\n                  cursor: \"pointer\"\n                },\n                title: \"\\u5220\\u9664\\u6B64\\u6A21\\u5757\",\n                onClick: () => {\n                  this.props.doDeleteModule(item.id);\n                },\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 261\n                },\n                __self: this\n              }, jsx(\"i\", {\n                className: \"fa fa-times\",\n                \"aria-hidden\": \"true\",\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 266\n                },\n                __self: this\n              })), jsx(\"span\", {\n                style: {\n                  float: \"right\",\n                  margin: \"0 10px 0 0\",\n                  cursor: \"pointer\"\n                },\n                title: \"\\u6A21\\u5757\\u8BBE\\u7F6E\",\n                onClick: () => this.showModal(item.id, item.viewType),\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 268\n                },\n                __self: this\n              }, jsx(\"i\", {\n                className: \"fa fa-cog\",\n                \"aria-hidden\": \"true\",\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 273\n                },\n                __self: this\n              }))), jsx(TemplateForColumn, {\n                pageId: this.props.id,\n                env: \"set\",\n                autoHeight: compiledPosition ? compiledPosition.h * 30 - 10 - 70 : 13 * 30 - 10 - 70,\n                showViewData: _.cloneDeep(item),\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 276\n                },\n                __self: this\n              })));\n            } else if (item.viewType === 'table') {\n              divArry.push(jsx(\"div\", {\n                style: {\n                  background: \"rgba(0,0,0,0.4)\",\n                  borderRadius: \"5px\",\n                  overflow: \"hidden\"\n                },\n                key: item.id,\n                \"data-grid\": compiledPosition,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 281\n                },\n                __self: this\n              }, jsx(\"div\", {\n                className: \"moduleHeader\",\n                style: {\n                  width: \"100%\",\n                  height: \"50px\",\n                  lineHeight: \"50px\"\n                },\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 282\n                },\n                __self: this\n              }, jsx(\"span\", {\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 283\n                },\n                __self: this\n              }, item.data ? item.data.name : ''), jsx(\"span\", {\n                style: {\n                  float: \"right\",\n                  cursor: \"pointer\"\n                },\n                title: \"\\u5220\\u9664\\u6B64\\u6A21\\u5757\",\n                onClick: () => {\n                  this.props.doDeleteModule(item.id);\n                },\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 284\n                },\n                __self: this\n              }, jsx(\"i\", {\n                className: \"fa fa-times\",\n                \"aria-hidden\": \"true\",\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 289\n                },\n                __self: this\n              })), jsx(\"span\", {\n                style: {\n                  float: \"right\",\n                  margin: \"0 10px 0 0\",\n                  cursor: \"pointer\"\n                },\n                title: \"\\u6A21\\u5757\\u8BBE\\u7F6E\",\n                onClick: () => this.showModal(item.id, item.viewType),\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 291\n                },\n                __self: this\n              }, jsx(\"i\", {\n                className: \"fa fa-cog\",\n                \"aria-hidden\": \"true\",\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 296\n                },\n                __self: this\n              }))), jsx(TemplateForTable, {\n                pageId: this.props.id,\n                env: \"set\",\n                autoHeight: compiledPosition ? compiledPosition.h * 30 - 10 - 70 : 13 * 30 - 10 - 70,\n                showViewData: _.cloneDeep(item),\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 299\n                },\n                __self: this\n              })));\n            } else if (item.viewType === 'pie') {\n              divArry.push(jsx(\"div\", {\n                style: {\n                  background: \"rgba(0,0,0,0.4)\",\n                  borderRadius: \"5px\",\n                  overflow: \"hidden\"\n                },\n                key: item.id,\n                \"data-grid\": compiledPosition,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 304\n                },\n                __self: this\n              }, jsx(\"div\", {\n                className: \"moduleHeader\",\n                style: {\n                  width: \"100%\",\n                  height: \"50px\",\n                  lineHeight: \"50px\"\n                },\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 305\n                },\n                __self: this\n              }, jsx(\"span\", {\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 306\n                },\n                __self: this\n              }, item.data ? item.data.name : ''), jsx(\"span\", {\n                style: {\n                  float: \"right\",\n                  cursor: \"pointer\"\n                },\n                title: \"\\u5220\\u9664\\u6B64\\u6A21\\u5757\",\n                onClick: () => {\n                  this.props.doDeleteModule(item.id);\n                },\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 307\n                },\n                __self: this\n              }, jsx(\"i\", {\n                className: \"fa fa-times\",\n                \"aria-hidden\": \"true\",\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 312\n                },\n                __self: this\n              })), jsx(\"span\", {\n                style: {\n                  float: \"right\",\n                  margin: \"0 10px 0 0\",\n                  cursor: \"pointer\"\n                },\n                title: \"\\u6A21\\u5757\\u8BBE\\u7F6E\",\n                onClick: () => this.showModal(item.id, item.viewType),\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 314\n                },\n                __self: this\n              }, jsx(\"i\", {\n                className: \"fa fa-cog\",\n                \"aria-hidden\": \"true\",\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 319\n                },\n                __self: this\n              }))), jsx(TemplateForPie, {\n                pageId: this.props.id,\n                env: \"set\",\n                autoHeight: compiledPosition ? compiledPosition.h * 30 - 10 - 70 : 13 * 30 - 10 - 70,\n                showViewData: _.cloneDeep(item),\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 322\n                },\n                __self: this\n              })));\n            } else if (item.viewType === 'map') {\n              divArry.push(jsx(\"div\", {\n                style: {\n                  background: \"rgba(0,0,0,0.4)\",\n                  borderRadius: \"5px\",\n                  overflow: \"hidden\"\n                },\n                key: item.id,\n                \"data-grid\": compiledPosition,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 327\n                },\n                __self: this\n              }, jsx(\"div\", {\n                className: \"moduleHeader\",\n                style: {\n                  width: \"100%\",\n                  height: \"50px\",\n                  lineHeight: \"50px\"\n                },\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 328\n                },\n                __self: this\n              }, jsx(\"span\", {\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 329\n                },\n                __self: this\n              }, item.data ? item.data.name : ''), jsx(\"span\", {\n                style: {\n                  float: \"right\",\n                  cursor: \"pointer\"\n                },\n                title: \"\\u5220\\u9664\\u6B64\\u6A21\\u5757\",\n                onClick: () => {\n                  this.props.doDeleteModule(item.id);\n                },\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 330\n                },\n                __self: this\n              }, jsx(\"i\", {\n                className: \"fa fa-times\",\n                \"aria-hidden\": \"true\",\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 335\n                },\n                __self: this\n              })), jsx(\"span\", {\n                style: {\n                  float: \"right\",\n                  margin: \"0 10px 0 0\",\n                  cursor: \"pointer\"\n                },\n                title: \"\\u6A21\\u5757\\u8BBE\\u7F6E\",\n                onClick: () => this.showModal(item.id, item.viewType),\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 337\n                },\n                __self: this\n              }, jsx(\"i\", {\n                className: \"fa fa-cog\",\n                \"aria-hidden\": \"true\",\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 342\n                },\n                __self: this\n              }))), jsx(TemplateForMap, {\n                pageId: this.props.id,\n                env: \"set\",\n                autoHeight: compiledPosition ? compiledPosition.h * 30 - 10 - 70 : 13 * 30 - 10 - 70,\n                showViewData: _.cloneDeep(item),\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 345\n                },\n                __self: this\n              })));\n            } else if (item.viewType === 'calc') {\n              divArry.push(jsx(\"div\", {\n                style: {\n                  background: \"rgba(0,0,0,0.4)\",\n                  borderRadius: \"5px\",\n                  overflow: \"hidden\"\n                },\n                key: item.id,\n                \"data-grid\": compiledPosition,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 350\n                },\n                __self: this\n              }, jsx(\"div\", {\n                className: \"moduleHeader\",\n                style: {\n                  width: \"100%\",\n                  height: \"50px\",\n                  lineHeight: \"50px\"\n                },\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 351\n                },\n                __self: this\n              }, jsx(\"span\", {\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 352\n                },\n                __self: this\n              }, item.data ? item.data.name : ''), jsx(\"span\", {\n                style: {\n                  float: \"right\",\n                  cursor: \"pointer\"\n                },\n                title: \"\\u5220\\u9664\\u6B64\\u6A21\\u5757\",\n                onClick: () => {\n                  this.props.doDeleteModule(item.id);\n                },\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 353\n                },\n                __self: this\n              }, jsx(\"i\", {\n                className: \"fa fa-times\",\n                \"aria-hidden\": \"true\",\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 358\n                },\n                __self: this\n              })), jsx(\"span\", {\n                style: {\n                  float: \"right\",\n                  margin: \"0 10px 0 0\",\n                  cursor: \"pointer\"\n                },\n                title: \"\\u6A21\\u5757\\u8BBE\\u7F6E\",\n                onClick: () => this.showModal(item.id, item.viewType),\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 360\n                },\n                __self: this\n              }, jsx(\"i\", {\n                className: \"fa fa-cog\",\n                \"aria-hidden\": \"true\",\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 365\n                },\n                __self: this\n              }))), jsx(TemplateForCalc, {\n                pageId: this.props.id,\n                env: \"set\",\n                autoHeight: compiledPosition ? compiledPosition.h * 30 - 10 - 70 : 13 * 30 - 10 - 70,\n                showViewData: _.cloneDeep(item),\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 368\n                },\n                __self: this\n              })));\n            }\n          }\n        });\n      }\n\n      return divArry;\n    };\n  }\n\n  componentDidMount() {\n    this._isMounted = true;\n    this.setState({\n      modules: this.props.modules\n    }); // wyAxiosPost('Screen/getScreen',{},(result)=>{\n    //   const responseData = result.data.msg.updateTime\n    //   this.setState({\n    //     updateTime: responseData\n    //   })\n    // })\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (!_.isEqual(this.props.modules, nextProps.modules)) {\n      if (this._isMounted) {\n        this.setState({\n          modules: _.cloneDeep(nextProps.modules)\n        });\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false;\n  }\n\n  render() {\n    return jsx(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 383\n      },\n      __self: this\n    }, jsx(\"div\", {\n      style: {\n        width: \"100%\",\n        height: \"30px\",\n        lineHeight: \"30px\",\n        textAlign: \"right\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 384\n      },\n      __self: this\n    }, jsx(\"span\", {\n      style: {\n        float: \"left\",\n        marginLeft: \"20px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 385\n      },\n      __self: this\n    }, jsx(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 386\n      },\n      __self: this\n    }, \"\\u6570\\u636E\\u66F4\\u65B0\\u95F4\\u9694\\uFF1A\"), jsx(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 387\n      },\n      __self: this\n    }, jsx(_Select, {\n      style: {\n        minWidth: \"120px\"\n      },\n      value: this.state.updateTime,\n      onChange: this.updateTimeChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 388\n      },\n      __self: this\n    }, jsx(Option, {\n      value: \"0\",\n      key: \"mykey\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 393\n      },\n      __self: this\n    }, \"\\u4E0D\\u81EA\\u52A8\\u66F4\\u65B0\"), jsx(Option, {\n      value: \"60\",\n      key: \"60s\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 394\n      },\n      __self: this\n    }, \"60s\"), jsx(Option, {\n      value: \"300\",\n      key: \"300s\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 395\n      },\n      __self: this\n    }, \"300s\")))), jsx(_Button, {\n      size: \"small\",\n      type: \"primary\",\n      title: \"\\u4FDD\\u5B58\\u9875\\u9762\",\n      onClick: this.saveModules,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 399\n      },\n      __self: this\n    }, \"\\u4FDD\\u5B58\")), jsx(ReactGridLayout, Object.assign({}, this.props, {\n      draggableHandle: \".moduleHeader\",\n      useCSSTransforms: true,\n      onLayoutChange: this.onLayoutChange,\n      style: {\n        position: \"relative\"\n      },\n      layout: this.state.layout,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 401\n      },\n      __self: this\n    }), this.generatedView()), jsx(ModalTypeContainer, {\n      title: \"\\u6A21\\u5757\\u8BBE\\u7F6E\",\n      visible: this.state.visible,\n      handleCancel: this.handleCancel,\n      handleOk: data => this.handleOk(data),\n      viewType: this.state.viewType,\n      setId: this.state.setId,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 420\n      },\n      __self: this\n    }));\n  }\n\n}\n\nGenerateView.defaultProps = {\n  className: \"layout\",\n  cols: 24,\n  margin: [10, 10],\n  rowHeight: 20,\n  autoSize: true,\n  onLayoutChange: function () {}\n};\nexport default GenerateView;","map":{"version":3,"sources":["/industry/app/src/DashboardManage/GenerateView.js"],"names":["jsx","css","React","Component","RGL","WidthProvider","_","forName","wyAxiosPost","TemplateForLine","TemplateForColumn","TemplateForTable","TemplateForPie","TemplateForMap","TemplateForCalc","ModalTypeContainer","require","ReactGridLayout","Option","GenerateView","state","modules","layout","setId","viewType","moduleName","dataMethod","updateTime","visible","dataSourceList","onLayoutChange","newLayout","length","map","item","i","h","w","x","y","push","props","doSetPosition","showModal","_isMounted","setState","handleOk","data","erroList","validateField","key","undefined","keys","Object","doSetData","handleCancel","str","index","warning","e","dataMethodChange","value","api","name","updateTimeChange","saveModules","info","id","result","responseData","msg","status","onClose","success","generatedView","divArry","compiledPosition","position","parseInt","assign","background","borderRadius","overflow","width","height","lineHeight","float","display","cursor","doDeleteModule","margin","cloneDeep","componentDidMount","componentWillReceiveProps","nextProps","isEqual","componentWillUnmount","render","textAlign","marginLeft","minWidth","defaultProps","className","cols","rowHeight","autoSize"],"mappings":"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","sourcesContent":["/** @jsx jsx */\r\nimport { jsx, css } from '@emotion/core'\r\nimport React ,{ Component } from 'react'\r\nimport RGL, { WidthProvider } from \"react-grid-layout\"\r\nimport _ from 'lodash'\r\nimport { Button, Modal, Input, Select, message } from 'antd'\r\n\r\nimport { forName } from '../components/RegExp'\r\nimport { wyAxiosPost } from '../components/WyAxios'\r\nimport TemplateForLine from './TemplateForLine'\r\nimport TemplateForColumn from './TemplateForColumn'\r\nimport TemplateForTable from './TemplateForTable'\r\nimport TemplateForPie from './TemplateForPie'\r\nimport TemplateForMap from './TemplateForMap'\r\nimport TemplateForCalc from './TemplateForCalc'\r\n\r\nimport ModalTypeContainer from './ModalTypeContainer'\r\nrequire('../../node_modules/react-grid-layout/css/styles.css')\r\nrequire('../../node_modules/react-resizable/css/styles.css')\r\nconst ReactGridLayout = WidthProvider(RGL);\r\nconst Option = Select.Option\r\nclass GenerateView extends Component{\r\n  static defaultProps = {\r\n    className: \"layout\",\r\n    cols: 24,\r\n    margin:[10,10],\r\n    rowHeight: 20,\r\n    autoSize: true,\r\n    onLayoutChange: function(){}\r\n  }\r\n  state = {\r\n    modules:[],\r\n    layout:[],\r\n\r\n    setId:'',\r\n    viewType:'',\r\n    moduleName:'',\r\n    dataMethod:'',\r\n    updateTime:'0',\r\n\r\n    visible: false,\r\n    dataSourceList:[],\r\n  }\r\n  componentDidMount(){\r\n    this._isMounted = true\r\n    this.setState({\r\n      modules: this.props.modules\r\n    })\r\n    // wyAxiosPost('Screen/getScreen',{},(result)=>{\r\n    //   const responseData = result.data.msg.updateTime\r\n    //   this.setState({\r\n    //     updateTime: responseData\r\n    //   })\r\n    // })\r\n  }\r\n  componentWillReceiveProps(nextProps){\r\n    if(! _.isEqual(this.props.modules,nextProps.modules)){\r\n      if(this._isMounted){\r\n        this.setState({\r\n          modules: _.cloneDeep(nextProps.modules)\r\n        })\r\n      }\r\n    }\r\n  }\r\n\r\n  onLayoutChange = (layout)=>{\r\n    const newLayout = []\r\n    if(layout && layout.length>0){\r\n      layout.map(item=>{\r\n        const {i,h,w,x,y} = item\r\n        newLayout.push({i,h,w,x,y})\r\n      })\r\n    }\r\n    if(newLayout.length>0){\r\n      this.props.doSetPosition(newLayout)\r\n    }\r\n  }\r\n  showModal = (setId,viewType) => {\r\n    if(this._isMounted){\r\n      this.setState({\r\n        setId,\r\n        viewType\r\n      },()=>{\r\n        this.setState({\r\n          visible: true\r\n        })\r\n      })\r\n    }\r\n\r\n    // this.state.modules.map((item,index)=>{\r\n    //   if(item.id === id){\r\n    //     this.setState({\r\n    //       moduleName: this.state.modules[index].data?this.state.modules[index].data.moduleName:'',\r\n    //       dataMethod: this.state.modules[index].data?this.state.modules[index].data.dataMethod:'',\r\n    //     })\r\n    //     return\r\n    //   }\r\n    // })\r\n    // this.setState({\r\n    //   visible: true,\r\n    //   setId: id,\r\n    //   viewType\r\n    // },()=>{\r\n      // wyAxiosPost('Screen/getScreenApi',{viewType: this.state.viewType},(result)=>{\r\n      //   const responseData = result.data.msg\r\n      //   this.setState({\r\n      //     dataSourceList: _.cloneDeep(responseData)\r\n      //   })\r\n      // })\r\n     //});\r\n  }\r\n\r\n  handleOk = (data) => {\r\n    const erroList = []\r\n    const validateField = (key)=>{\r\n      if(key === 'name'){\r\n        if(data[key] === '' || data[key] === undefined){\r\n          erroList.push('名称不能为空')\r\n        }\r\n      }else if(key === 'app_name'){\r\n        if(data[key] === '' || data[key] === undefined){\r\n          erroList.push('应用不能为空')\r\n        }\r\n      }else if(key === 's_map'){\r\n        if(data[key] === '' || data[key] === undefined){\r\n          erroList.push('地图不能为空')\r\n        }\r\n      }else if(key === 's_city'){\r\n        if(data[key] === '' || data[key] === undefined){\r\n          erroList.push('城市不能为空')\r\n        }\r\n      }else if(key === 'field'){\r\n        if(data[key] === '' || data[key] === undefined){\r\n          erroList.push('字段不能为空')\r\n        }\r\n      }\r\n    }\r\n    const keys = Object.keys(data)\r\n    if(keys && keys.length>0){\r\n      keys.map(item=>{\r\n        validateField(item)\r\n      })\r\n    }\r\n    if(erroList.length === 0){\r\n      this.props.doSetData(data)\r\n      this.handleCancel()\r\n    }else{\r\n      let str = ''\r\n      erroList.map((item,index)=>{\r\n        str += index+1+'.'+item+'  '\r\n      })\r\n      message.warning(str)\r\n    }\r\n  }\r\n  handleCancel = (e) => {\r\n    if(this._isMounted){\r\n      this.setState({\r\n        visible: false,\r\n        setId: '',\r\n        viewType:'',\r\n        moduleName:'',\r\n        dataMethod:'',\r\n      });\r\n    }\r\n  }\r\n  // moduleNameChange = (e)=>{\r\n  //   this.setState({\r\n  //     moduleName: e.target.value\r\n  //   })\r\n  // }\r\n  dataMethodChange = (value)=>{\r\n    if(this._isMounted){\r\n      let moduleName = ''\r\n      for(let item of this.state.dataSourceList){\r\n        if(value === item.api){\r\n          moduleName = item.name\r\n          break\r\n        }\r\n      }\r\n      this.setState({\r\n        dataMethod: value,\r\n        moduleName\r\n      })\r\n    }\r\n  }\r\n  updateTimeChange = (value)=>{\r\n    if(this._isMounted){\r\n      this.setState({\r\n        updateTime: value\r\n      })\r\n    }\r\n  }\r\n\r\n  //保存页面\r\n  saveModules = ()=>{\r\n    const info = {}\r\n    info.modules = this.props.modules\r\n    info.updateTime = this.state.updateTime\r\n    info.id = this.props.id\r\n    wyAxiosPost('Dashboard/saveModule',{info},(result)=>{\r\n      const responseData = result.data.msg\r\n      if(responseData.status === 1){\r\n        this.props.onClose()\r\n        message.success(responseData.msg)\r\n      }else{\r\n        message.warning(responseData.msg)\r\n      }\r\n    })\r\n\r\n    // wyAxiosPost('Screen/saveScreen',{info},(result)=>{\r\n    //   const responseData = result.data\r\n    //   if(responseData.status === 1){\r\n    //     this.props.closeWindow()\r\n    //     message.success(responseData.msg)\r\n    //   }else{\r\n    //     message.warning(responseData.msg)\r\n    //   }\r\n    // })\r\n  }\r\n  generatedView =()=>{\r\n    let divArry = []\r\n    if(this.state.modules && this.state.modules.length>0){\r\n      this.state.modules.map((item,index)=>{\r\n        let compiledPosition = {}\r\n        if(item.position){\r\n          const h = parseInt(item.position.h)\r\n          const w = parseInt(item.position.w)\r\n          const x = parseInt(item.position.x)\r\n          const y = parseInt(item.position.y)\r\n          compiledPosition = Object.assign({},{h,w,x,y})\r\n        }\r\n        if(Object.keys(compiledPosition).length > 0){\r\n          if(item.viewType === 'line' || item.viewType === 'bar'){\r\n            divArry.push(\r\n              <div style={{background: \"rgba(0,0,0,0.4)\",borderRadius:\"5px\",overflow:\"hidden\"}} key={item.id} data-grid={compiledPosition}>\r\n                <div className=\"moduleHeader\" style={{width: \"100%\",height:\"50px\",lineHeight:\"50px\"}}>\r\n                  <span>{item.data?item.data.name:''}</span>\r\n                  <span\r\n                    style={{float:\"right\",display:\"inline-block\", cursor:\"pointer\"}}\r\n                    title=\"删除此模块\"\r\n                    onClick={()=>{this.props.doDeleteModule(item.id)}}\r\n                  >\r\n                  <i className=\"fa fa-times\" aria-hidden=\"true\"></i>\r\n                  </span>\r\n                  <span\r\n                    style={{float:\"right\",margin:\"0 10px 0 0\", cursor:\"pointer\"}}\r\n                    title=\"模块设置\"\r\n                    onClick={()=>(this.showModal(item.id,item.viewType))}\r\n                  >\r\n                    <i className=\"fa fa-cog\" aria-hidden=\"true\"></i>\r\n                  </span>\r\n                </div>\r\n                <TemplateForLine pageId={this.props.id} env=\"set\" autoHeight={compiledPosition?compiledPosition.h*30-10-70:13*30-10-70} showViewData={_.cloneDeep(item)}/>\r\n              </div>\r\n            )\r\n          }else if(item.viewType === 'column'){\r\n            divArry.push(\r\n              <div style={{background: \"rgba(0,0,0,0.4)\",borderRadius:\"5px\",overflow:\"hidden\"}} key={item.id} data-grid={compiledPosition}>\r\n                <div className=\"moduleHeader\" style={{width: \"100%\",height:\"50px\",lineHeight:\"50px\"}}>\r\n                  <span>{item.data?item.data.name:''}</span>\r\n                  <span\r\n                    style={{float:\"right\", cursor:\"pointer\"}}\r\n                    title=\"删除此模块\"\r\n                    onClick={()=>{this.props.doDeleteModule(item.id)}}\r\n                  >\r\n                  <i className=\"fa fa-times\" aria-hidden=\"true\"></i>\r\n                  </span>\r\n                  <span\r\n                    style={{float:\"right\",margin:\"0 10px 0 0\", cursor:\"pointer\"}}\r\n                    title=\"模块设置\"\r\n                    onClick={()=>(this.showModal(item.id,item.viewType))}\r\n                  >\r\n                    <i className=\"fa fa-cog\" aria-hidden=\"true\"></i>\r\n                  </span>\r\n                </div>\r\n                <TemplateForColumn pageId={this.props.id} env=\"set\" autoHeight={compiledPosition?compiledPosition.h*30-10-70:13*30-10-70} showViewData={_.cloneDeep(item)}/>\r\n              </div>\r\n            )\r\n          }else if(item.viewType === 'table'){\r\n            divArry.push(\r\n              <div style={{background: \"rgba(0,0,0,0.4)\",borderRadius:\"5px\",overflow:\"hidden\"}} key={item.id} data-grid={compiledPosition}>\r\n                <div className=\"moduleHeader\" style={{width: \"100%\",height:\"50px\",lineHeight:\"50px\"}}>\r\n                  <span>{item.data?item.data.name:''}</span>\r\n                  <span\r\n                    style={{float:\"right\", cursor:\"pointer\"}}\r\n                    title=\"删除此模块\"\r\n                    onClick={()=>{this.props.doDeleteModule(item.id)}}\r\n                  >\r\n                  <i className=\"fa fa-times\" aria-hidden=\"true\"></i>\r\n                  </span>\r\n                  <span\r\n                    style={{float:\"right\",margin:\"0 10px 0 0\", cursor:\"pointer\"}}\r\n                    title=\"模块设置\"\r\n                    onClick={()=>(this.showModal(item.id,item.viewType))}\r\n                  >\r\n                    <i className=\"fa fa-cog\" aria-hidden=\"true\"></i>\r\n                  </span>\r\n                </div>\r\n                <TemplateForTable pageId={this.props.id} env=\"set\" autoHeight={compiledPosition?compiledPosition.h*30-10-70:13*30-10-70} showViewData={_.cloneDeep(item)}/>\r\n              </div>\r\n            )\r\n          }else if(item.viewType === 'pie'){\r\n            divArry.push(\r\n              <div style={{background: \"rgba(0,0,0,0.4)\",borderRadius:\"5px\",overflow:\"hidden\"}} key={item.id} data-grid={compiledPosition}>\r\n                <div className=\"moduleHeader\" style={{width: \"100%\",height:\"50px\",lineHeight:\"50px\"}}>\r\n                  <span>{item.data?item.data.name:''}</span>\r\n                  <span\r\n                    style={{float:\"right\", cursor:\"pointer\"}}\r\n                    title=\"删除此模块\"\r\n                    onClick={()=>{this.props.doDeleteModule(item.id)}}\r\n                  >\r\n                  <i className=\"fa fa-times\" aria-hidden=\"true\"></i>\r\n                  </span>\r\n                  <span\r\n                    style={{float:\"right\",margin:\"0 10px 0 0\", cursor:\"pointer\"}}\r\n                    title=\"模块设置\"\r\n                    onClick={()=>(this.showModal(item.id,item.viewType))}\r\n                  >\r\n                    <i className=\"fa fa-cog\" aria-hidden=\"true\"></i>\r\n                  </span>\r\n                </div>\r\n                <TemplateForPie pageId={this.props.id} env=\"set\" autoHeight={compiledPosition?compiledPosition.h*30-10-70:13*30-10-70} showViewData={_.cloneDeep(item)}/>\r\n              </div>\r\n            )\r\n          }else if(item.viewType === 'map'){\r\n             divArry.push(\r\n               <div style={{background: \"rgba(0,0,0,0.4)\",borderRadius:\"5px\",overflow:\"hidden\"}} key={item.id} data-grid={compiledPosition}>\r\n                 <div className=\"moduleHeader\" style={{width: \"100%\",height:\"50px\",lineHeight:\"50px\"}}>\r\n                   <span>{item.data?item.data.name:''}</span>\r\n                   <span\r\n                     style={{float:\"right\", cursor:\"pointer\"}}\r\n                     title=\"删除此模块\"\r\n                     onClick={()=>{this.props.doDeleteModule(item.id)}}\r\n                   >\r\n                   <i className=\"fa fa-times\" aria-hidden=\"true\"></i>\r\n                   </span>\r\n                   <span\r\n                     style={{float:\"right\",margin:\"0 10px 0 0\", cursor:\"pointer\"}}\r\n                     title=\"模块设置\"\r\n                     onClick={()=>(this.showModal(item.id,item.viewType))}\r\n                   >\r\n                     <i className=\"fa fa-cog\" aria-hidden=\"true\"></i>\r\n                   </span>\r\n                 </div>\r\n                 <TemplateForMap pageId={this.props.id} env=\"set\" autoHeight={compiledPosition?compiledPosition.h*30-10-70:13*30-10-70} showViewData={_.cloneDeep(item)}/>\r\n               </div>\r\n            )\r\n          }else if(item.viewType === 'calc'){\r\n            divArry.push(\r\n              <div style={{background: \"rgba(0,0,0,0.4)\",borderRadius:\"5px\",overflow:\"hidden\"}} key={item.id} data-grid={compiledPosition}>\r\n                <div className=\"moduleHeader\" style={{width: \"100%\",height:\"50px\",lineHeight:\"50px\"}}>\r\n                  <span>{item.data?item.data.name:''}</span>\r\n                  <span\r\n                    style={{float:\"right\", cursor:\"pointer\"}}\r\n                    title=\"删除此模块\"\r\n                    onClick={()=>{this.props.doDeleteModule(item.id)}}\r\n                  >\r\n                  <i className=\"fa fa-times\" aria-hidden=\"true\"></i>\r\n                  </span>\r\n                  <span\r\n                    style={{float:\"right\",margin:\"0 10px 0 0\", cursor:\"pointer\"}}\r\n                    title=\"模块设置\"\r\n                    onClick={()=>(this.showModal(item.id,item.viewType))}\r\n                  >\r\n                    <i className=\"fa fa-cog\" aria-hidden=\"true\"></i>\r\n                  </span>\r\n                </div>\r\n                <TemplateForCalc pageId={this.props.id} env=\"set\" autoHeight={compiledPosition?compiledPosition.h*30-10-70:13*30-10-70} showViewData={_.cloneDeep(item)}/>\r\n              </div>\r\n           )\r\n          }\r\n        }\r\n      })\r\n    }\r\n    return divArry\r\n  }\r\n\r\n  componentWillUnmount(){\r\n    this._isMounted = false\r\n  }\r\n  render(){\r\n    return (\r\n      <div>\r\n        <div style={{width: \"100%\",height:\"30px\",lineHeight:\"30px\", textAlign: \"right\"}}>\r\n          <span style={{float:\"left\",marginLeft:\"20px\"}}>\r\n            <span>数据更新间隔：</span>\r\n            <span>\r\n              <Select\r\n                style={{minWidth:\"120px\"}}\r\n                value={this.state.updateTime}\r\n                onChange={this.updateTimeChange}\r\n              >\r\n                <Option value=\"0\" key=\"mykey\">不自动更新</Option>\r\n                <Option value=\"60\" key=\"60s\">60s</Option>\r\n                <Option value=\"300\" key=\"300s\">300s</Option>\r\n              </Select>\r\n            </span>\r\n          </span>\r\n          <Button size=\"small\" type=\"primary\" title=\"保存页面\" onClick={this.saveModules} >保存</Button>\r\n        </div>\r\n        <ReactGridLayout\r\n          {...this.props}\r\n          draggableHandle=\".moduleHeader\"\r\n          useCSSTransforms={true}\r\n          onLayoutChange={this.onLayoutChange}\r\n          style={{position: \"relative\"}}\r\n          layout={this.state.layout}\r\n        >\r\n          {this.generatedView()}\r\n        </ReactGridLayout>\r\n        {\r\n          // <Modal\r\n          //   title=\"模块设置\"\r\n          //   visible={this.state.visible}\r\n          //   onOk={this.handleOk}\r\n          //   onCancel={this.handleCancel}\r\n          // >\r\n        }\r\n\r\n          <ModalTypeContainer\r\n            title=\"模块设置\"\r\n            visible={this.state.visible}\r\n            handleCancel={this.handleCancel}\r\n            handleOk={(data)=>this.handleOk(data)}\r\n            viewType={this.state.viewType}\r\n            setId={this.state.setId}\r\n          />\r\n\r\n          {\r\n            //</Modal>\r\n          }\r\n\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n\r\nexport default GenerateView\r\n"]},"metadata":{},"sourceType":"module"}